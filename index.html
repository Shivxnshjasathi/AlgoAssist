<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Codex</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0c0a18;
            /* The main container will handle scrolling, not the body */
        }

        .aurora-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.4;
        }

        .aurora-background div {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            animation: aurora-animation 20s infinite alternate;
        }

        .aurora-shape1 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(167, 139, 250, 0.8) 0%, rgba(167, 139, 250, 0) 70%);
            top: -10%;
            left: -10%;
        }

        .aurora-shape2 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(99, 102, 241, 0.8) 0%, rgba(99, 102, 241, 0) 70%);
            bottom: -15%;
            right: -5%;
            animation-delay: 5s;
        }
        
        .aurora-shape3 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(236, 72, 153, 0.6) 0%, rgba(236, 72, 153, 0) 70%);
            top: 20%;
            right: 20%;
            animation-delay: 10s;
        }

        @keyframes aurora-animation {
            0% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(100px, 50px) scale(1.2); }
            100% { transform: translate(-50px, -100px) scale(0.9); }
        }

        .glass-container {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden; /* Keep for border-radius and shine effect */
            height: 100%; /* Full height on mobile */
            display: flex;
            flex-direction: column;
        }

        @media (min-width: 640px) {
            .glass-container {
                max-height: 90vh;
                height: auto;
            }
        }


        main#app-content {
            overflow-y: auto; /* Allow this section to scroll */
            flex-grow: 1;
        }

        /* Custom Scrollbar Styling */
        main#app-content::-webkit-scrollbar, .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        main#app-content::-webkit-scrollbar-track, .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }
        main#app-content::-webkit-scrollbar-thumb, .chat-messages::-webkit-scrollbar-thumb {
            background-color: rgba(99, 102, 241, 0.5);
            border-radius: 10px;
            border: 2px solid transparent;
            background-clip: content-box;
        }
        main#app-content::-webkit-scrollbar-thumb:hover, .chat-messages::-webkit-scrollbar-thumb:hover {
            background-color: rgba(99, 102, 241, 0.8);
        }

        .shine-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at var(--shine-x) var(--shine-y), rgba(255, 255, 255, 0.1), transparent 40%);
            pointer-events: none;
            transition: opacity 0.2s;
            opacity: 0;
        }

        .glass-container:hover .shine-effect {
            opacity: 1;
        }

        .ai-thinking-dot {
            width: 8px;
            height: 8px;
            background-color: #9CA3AF;
            border-radius: 50%;
            animation: ai-thinking 1.4s infinite ease-in-out both;
        }
        .ai-thinking-dot:nth-child(1) { animation-delay: -0.32s; }
        .ai-thinking-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes ai-thinking {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }

        /* Styling for Markdown-generated content */
        .markdown-content pre {
            background-color: #0c0a18;
            border: 1px solid #374151;
            border-radius: 0.75rem;
            padding: 1.25rem;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-top: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        .markdown-content code {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            color: #e5e7eb;
            font-size: 0.95rem;
            background-color: #2d3748;
            padding: 0.1rem 0.3rem;
            border-radius: 0.25rem;
        }
         .markdown-content pre code {
            background-color: transparent;
            padding: 0;
        }
        .markdown-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 1.75rem;
            margin-bottom: 1rem;
            color: #c4b5fd;
            border-bottom: 1px solid #4b5563;
            padding-bottom: 0.5rem;
        }
         .markdown-content h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #a78bfa;
        }
        .markdown-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
        }
         .markdown-content li {
            margin-bottom: 0.5rem;
        }
        .markdown-content p {
            margin-bottom: 1rem;
            line-height: 1.8;
            font-size: 1.05rem;
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
        }
        .nav-link.active {
            color: #c4b5fd;
            background-color: rgba(99, 102, 241, 0.2);
        }
        
        .sub-nav-link {
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .sub-nav-link.active {
            color: #c4b5fd;
            border-bottom-color: #c4b5fd;
        }


        /* --- NEW ANIMATIONS --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page {
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        .feature-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        /* Content reveal animation */
        .content-reveal {
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            opacity: 0;
            transform: translateY(15px);
        }

        .content-reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Mobile bottom nav active state */
        .mobile-nav-link.active {
             color: #c4b5fd;
        }

        /* --- CHATBOT STYLES --- */
        #chatbot-fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        #chatbot-fab:hover {
            transform: scale(1.1);
        }
        #chatbot-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 90vw;
            max-width: 400px;
            height: 70vh;
            max-height: 600px;
            z-index: 999;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            pointer-events: none;
        }
        #chatbot-container.visible {
            transform: translateY(0) scale(1);
            opacity: 1;
            pointer-events: auto;
        }
        .message {
            max-width: 80%;
        }
        .user-message {
            background-color: #4f46e5;
            color: white;
            align-self: flex-end;
        }
        .ai-message {
            background-color: #374151;
            color: #e5e7eb;
            align-self: flex-start;
        }

    </style>
</head>
<body class="text-gray-200 flex sm:items-center justify-center p-0 sm:p-4">
    <div class="aurora-background">
        <div class="aurora-shape1"></div>
        <div class="aurora-shape2"></div>
        <div class="aurora-shape3"></div>
    </div>

    <div class="w-full max-w-4xl mx-auto h-full sm:h-auto">
        <div class="glass-container rounded-none sm:rounded-3xl shadow-2xl">
            <div class="shine-effect"></div>
            <!-- Top Navigation (for Desktop) -->
            <nav class="p-4 border-b border-white/10 flex-shrink-0">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="p-2 bg-gray-900/50 rounded-full border border-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-400"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
                        </div>
                        <h1 class="text-xl font-bold text-gray-100 tracking-tight">Codex</h1>
                    </div>
                    <!-- Desktop Nav Buttons -->
                    <div class="hidden sm:flex space-x-1 sm:space-x-2 bg-gray-900/50 p-1 rounded-full border border-gray-700">
                        <button class="nav-link px-3 sm:px-4 py-2 rounded-full text-sm font-semibold" data-page="home">Home</button>
                        <button class="nav-link px-3 sm:px-4 py-2 rounded-full text-sm font-semibold" data-page="solver">Solver</button>
                        <button class="nav-link px-3 sm:px-4 py-2 rounded-full text-sm font-semibold" data-page="interview">Interview Prep</button>
                    </div>
                </div>
            </nav>

            <!-- Page Content -->
            <main id="app-content" class="pb-20 sm:pb-0">
                <!-- Home Page (Landing Page) -->
                <div id="home-page" class="page p-4 sm:p-6 md:p-10">
                    <div class="text-center">
                        <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold tracking-tight text-white">Your Personal AI Coding Assistant</h2>
                        <p class="mt-4 sm:mt-6 text-base sm:text-lg leading-8 text-gray-300">Stuck on a problem? Get comprehensive, step-by-step solution guides instantly. Understand the logic, explore different approaches, and master data structures and algorithms.</p>
                        <div class="mt-8 sm:mt-10 flex items-center justify-center gap-x-6">
                            <button id="start-solving-btn" class="bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-3 px-6 rounded-xl transition duration-300 ease-in-out transform hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 shadow-lg shadow-indigo-600/30">
                                Start Solving Now
                            </button>
                        </div>
                    </div>
                    <div class="mt-12 sm:mt-16 grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                        <div class="feature-card p-6 bg-gray-900/30 rounded-2xl border border-white/10">
                            <h3 class="text-lg font-semibold text-indigo-300">Detailed Explanations</h3>
                            <p class="mt-2 text-gray-400">Don't just get the code. Understand the 'why' behind every line with detailed explanations.</p>
                        </div>
                        <div class="feature-card p-6 bg-gray-900/30 rounded-2xl border border-white/10">
                            <h3 class="text-lg font-semibold text-indigo-300">Multiple Approaches</h3>
                            <p class="mt-2 text-gray-400">Explore various ways to tackle a problem, from brute-force to the most optimal solution.</p>
                        </div>
                        <div class="feature-card p-6 bg-gray-900/30 rounded-2xl border border-white/10">
                            <h3 class="text-lg font-semibold text-indigo-300">Multi-Language Support</h3>
                            <p class="mt-2 text-gray-400">Get solutions in your preferred language: Python, JavaScript, Java, or C++.</p>
                        </div>
                    </div>
                </div>

                <!-- Solver Page -->
                <div id="solver-page" class="page p-4 sm:p-6 md:p-8 hidden">
                    <div class="space-y-6">
                        <div class="relative">
                            <label for="problem-number-input" class="block text-sm font-medium text-gray-400 mb-2">LeetCode Problem Number or Title</label>
                            <div class="absolute inset-y-0 left-0 top-7 flex items-center pl-4 pointer-events-none">
                                <svg class="w-5 h-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><hash class="lucide lucide-hash" /><path d="M4 9h16"/><path d="M4 15h16"/><path d="M9 4v16"/><path d="M15 4v16"/></svg>
                            </div>
                            <input type="text" id="problem-number-input" placeholder="e.g., 1 or Two Sum" class="w-full bg-gray-900/70 border border-gray-700 rounded-xl p-4 pl-11 text-gray-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200">
                        </div>

                        <div class="relative">
                            <label for="language-select" class="block text-sm font-medium text-gray-400 mb-2">Programming Language</label>
                             <div class="absolute inset-y-0 left-0 top-7 flex items-center pl-4 pointer-events-none">
                                 <svg class="w-5 h-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="5 8 1 12 5 16"></polyline><polyline points="19 8 23 12 19 16"></polyline><line x1="15" x2="9" y1="4" y2="20"></line></svg>
                             </div>
                            <select id="language-select" class="w-full appearance-none bg-gray-900/70 border border-gray-700 rounded-xl p-4 pl-11 text-gray-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200">
                                <option value="Python">Python</option>
                                <option value="JavaScript">JavaScript</option>
                                <option value="Java">Java</option>
                                <option value="C++">C++</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 top-7 flex items-center pr-4 pointer-events-none">
                                <svg class="w-5 h-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" /></svg>
                            </div>
                        </div>

                        <div class="grid grid-cols-1">
                            <button id="solve-btn" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-4 px-4 rounded-xl transition duration-300 ease-in-out transform hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 flex items-center justify-center shadow-lg shadow-indigo-600/30">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
                                Get Solution Guide
                            </button>
                        </div>
                    </div>
                     <div id="response-container" class="mt-8 border-t border-white/10 pt-8 hidden content-reveal">
                         <div id="loading-indicator" class="flex items-center space-x-2 hidden">
                            <div class="ai-thinking-dot"></div>
                            <div class="ai-thinking-dot"></div>
                            <div class="ai-thinking-dot"></div>
                            <span class="text-gray-400">AI is generating a full solution guide...</span>
                        </div>
                        <div id="response-header" class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4 hidden">
                            <h3 class="text-lg font-semibold text-gray-300">Solution Guide</h3>
                            <div class="flex items-center space-x-2">
                                <button id="tts-btn" class="flex items-center text-gray-400 hover:text-white transition-colors p-2 rounded-lg bg-gray-900/50 hover:bg-gray-800/70">
                                    <svg id="tts-play-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                                    <svg id="tts-stop-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden"><rect x="6" y="6" width="12" height="12"></rect></svg>
                                </button>
                                <button id="youtube-btn" class="flex items-center text-gray-400 hover:text-white transition-colors p-2 rounded-lg bg-gray-900/50 hover:bg-gray-800/70">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-0"><path d="M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17"/><path d="m10 15 5-3-5-3z"/></svg>
                                </button>
                                <button id="pdf-btn" class="flex items-center text-gray-400 hover:text-white transition-colors p-2 rounded-lg bg-gray-900/50 hover:bg-gray-800/70">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                                </button>
                            </div>
                        </div>
                        <div id="ai-response" class="text-gray-300 leading-relaxed max-w-none markdown-content"></div>
                    </div>
                </div>
                
                <!-- Interview Prep Page -->
                <div id="interview-page" class="page p-4 sm:p-6 md:p-8 hidden">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                        <h2 class="text-2xl font-bold text-white">Interview Prep</h2>
                        <div class="flex space-x-2 border-b border-gray-700 self-start sm:self-center">
                            <button class="sub-nav-link active py-2 px-4 text-gray-300" data-view="questions">Practice Questions</button>
                            <button class="sub-nav-link py-2 px-4 text-gray-400" data-view="guide">Preparation Guide</button>
                        </div>
                    </div>

                    <!-- View for Practice Questions -->
                    <div id="questions-view">
                        <div class="space-y-4 sm:space-y-0 sm:flex sm:space-x-4 mb-6">
                            <input type="text" id="company-input" class="w-full bg-gray-900/70 border border-gray-700 rounded-xl p-4 text-gray-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200" placeholder="Company Name (e.g., Flipkart)">
                            <input type="text" id="role-input" class="w-full bg-gray-900/70 border border-gray-700 rounded-xl p-4 text-gray-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200" placeholder="Role (e.g., SDE 1)">
                            <button id="get-questions-btn" class="w-full sm:w-auto bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-4 px-6 rounded-xl transition duration-300 ease-in-out flex items-center justify-center">
                                Get Questions
                            </button>
                        </div>
                        <div id="questions-display" class="p-6 bg-gray-900/30 rounded-2xl border border-white/10 content-reveal visible">
                            <div id="questions-loading" class="hidden items-center space-x-2">
                                <div class="ai-thinking-dot"></div>
                                <div class="ai-thinking-dot"></div>
                                <div class="ai-thinking-dot"></div>
                                <span class="text-gray-400">Finding questions for you...</span>
                            </div>
                            <div id="questions-content" class="markdown-content">
                                <h3 class="text-xl font-semibold text-indigo-300">Get Started</h3>
                                <p class="mt-2 text-gray-400">Enter a company and role to get a list of targeted interview questions.</p>
                            </div>
                        </div>
                    </div>

                    <!-- View for Preparation Guide -->
                    <div id="guide-view" class="hidden markdown-content">
                        <h3>The Ultimate Interview Preparation Guide</h3>
                        
                        <h4>1. Master Data Structures & Algorithms (DSA)</h4>
                        <p>This is the foundation of most technical interviews. You should be able to understand, implement, and analyze the complexity of the following:</p>
                        <ul>
                            <li><strong>Arrays & Strings:</strong> Sorting, searching, two pointers, sliding window.</li>
                            <li><strong>Linked Lists:</strong> Singly, Doubly, fast & slow pointers.</li>
                            <li><strong>Stacks & Queues:</strong> Know their use cases (e.g., for DFS/BFS).</li>
                            <li><strong>Trees:</strong> Binary Trees, Binary Search Trees (BSTs), Traversals (In-order, Pre-order, Post-order, Level-order).</li>
                            <li><strong>Heaps:</strong> Min-Heap, Max-Heap, common problems like finding Kth largest element.</li>
                            <li><strong>Graphs:</strong> Representations (Adjacency List/Matrix), Traversals (BFS, DFS), common algorithms like Dijkstra's and Topological Sort.</li>
                            <li><strong>Tries:</strong> For string-related problems.</li>
                            <li><strong>Dynamic Programming:</strong> Understand the concepts of memoization and tabulation. Practice common patterns.</li>
                        </ul>

                        <h4>2. Understand Big O Notation</h4>
                        <p>For every algorithm you write, you must be able to analyze its time and space complexity. This is a critical part of the evaluation.</p>

                        <h4>3. Practice Problem Solving Patterns</h4>
                        <p>Don't just solve random problems. Identify common patterns that can be applied to a wide range of questions. Some key patterns include:</p>
                        <ul>
                            <li>Two Pointers</li>
                            <li>Sliding Window</li>
                            <li>Fast & Slow Pointers (Linked Lists)</li>
                            <li>Merge Intervals</li>
                            <li>Topological Sort (Graphs)</li>
                            <li>Depth-First Search (DFS) & Breadth-First Search (BFS)</li>
                        </ul>

                        <h4>4. System Design Fundamentals</h4>
                        <p>For mid-level and senior roles, system design is crucial. Even for junior roles, basic knowledge is expected. Study:</p>
                        <ul>
                            <li><strong>Core Concepts:</strong> Scalability, availability, reliability, latency, throughput.</li>
                            <li><strong>Building Blocks:</strong> Load Balancers, CDNs, Databases (SQL vs. NoSQL), Caching, Message Queues.</li>
                            <li><strong>Design Patterns:</strong> Practice designing common systems like a URL shortener, a social media feed, or a ride-sharing app.</li>
                        </ul>

                        <h4>5. Behavioral Questions</h4>
                        <p>Don't neglect the non-technical part. Prepare stories using the <strong>STAR method</strong> (Situation, Task, Action, Result) for questions like:</p>
                        <ul>
                            <li>"Tell me about a time you had a conflict with a coworker."</li>
                            <li>"Describe a challenging project you worked on."</li>
                            <li>"Why do you want to work at this company?"</li>
                        </ul>
                        <p>Be prepared to discuss your past projects, your role, and the technical decisions you made.</p>
                    </div>
                </div>


            </main>
            
            <!-- Bottom Navigation (for Mobile) -->
            <nav class="sm:hidden fixed bottom-0 left-0 right-0 bg-gray-900/80 backdrop-blur-sm border-t border-white/10 p-2 flex justify-around items-center">
                <button class="nav-link mobile-nav-link flex flex-col items-center justify-center text-gray-400 w-full py-1 rounded-lg" data-page="home">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                    <span class="text-xs font-medium mt-1">Home</span>
                </button>
                <button class="nav-link mobile-nav-link flex flex-col items-center justify-center text-gray-400 w-full py-1 rounded-lg" data-page="solver">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
                    <span class="text-xs font-medium mt-1">Solver</span>
                </button>
                <button class="nav-link mobile-nav-link flex flex-col items-center justify-center text-gray-400 w-full py-1 rounded-lg" data-page="interview">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/><path d="M12 14c-2.76 0-5 2.24-5 5h10c0-2.76-2.24-5-5-5Z"/><path d="M19 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/><path d="M19 12c-2.76 0-5 2.24-5 5h.5a3.5 3.5 0 0 1 3.5-3.5 3.5 3.5 0 0 1 3.5 3.5H22c0-2.76-2.24-5-5-5Z"/><path d="M5 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/><path d="M5 12c-2.76 0-5 2.24-5 5h.5a3.5 3.5 0 0 1 3.5-3.5A3.5 3.5 0 0 1 10.5 17H12c0-2.76-2.24-5-5-5Z"/></svg>
                    <span class="text-xs font-medium mt-1">Interview</span>
                </button>
                <!-- New Chatbot Button for Mobile -->
                <button id="mobile-chat-btn" class="flex flex-col items-center justify-center text-gray-400 w-full py-1 rounded-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"></path></svg>
                    <span class="text-xs font-medium mt-1">Chat</span>
                </button>
            </nav>
        </div>
        <p class="text-center text-gray-500 text-xs mt-8 pb-4">Powered by Pollinations.ai</p>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast-notification" class="fixed top-5 right-5 bg-gray-800 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 hidden transition-opacity duration-300">
        <p id="toast-message"></p>
    </div>

    <!-- Chatbot Floating Action Button (Desktop) -->
    <button id="chatbot-fab" class="hidden sm:block bg-indigo-600 hover:bg-indigo-500 text-white p-4 rounded-full shadow-lg">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"></path></svg>
    </button>

    <!-- Chatbot UI -->
    <div id="chatbot-container" class="glass-container rounded-2xl shadow-2xl flex flex-col">
        <!-- Chat Header -->
        <div class="flex-shrink-0 p-4 border-b border-white/10 flex justify-between items-center">
            <h3 class="font-bold text-lg">AI Assistant</h3>
            <button id="close-chatbot-btn" class="text-gray-400 hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <!-- Messages -->
        <div id="chat-messages" class="flex-grow p-4 space-y-4 overflow-y-auto flex flex-col">
            <!-- Example Message -->
            <div class="message ai-message p-3 rounded-lg">
                Hello! How can I help you today?
            </div>
        </div>
        <!-- Input Form -->
        <div class="flex-shrink-0 p-4 border-t border-white/10">
            <form id="chat-input-form" class="flex items-center space-x-2">
                <input type="text" id="chat-input" class="w-full bg-gray-900/70 border border-gray-700 rounded-lg p-3 text-gray-200 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Ask a question...">
                <button type="submit" class="bg-indigo-600 hover:bg-indigo-500 text-white p-3 rounded-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </form>
        </div>
    </div>


    <script>
        // jsPDF setup
        const { jsPDF } = window.jspdf;

        // Shine effect logic
        const container = document.querySelector('.glass-container');
        const shine = document.querySelector('.shine-effect');
        container.addEventListener('mousemove', e => {
            const rect = container.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            shine.style.setProperty('--shine-x', `${x}px`);
            shine.style.setProperty('--shine-y', `${y}px`);
        });

        // Page navigation logic
        // This selector now targets buttons in both the top and bottom nav bars
        const navLinks = document.querySelectorAll('.nav-link'); 
        const pages = {
            home: document.getElementById('home-page'),
            solver: document.getElementById('solver-page'),
            interview: document.getElementById('interview-page')
        };

        function showPage(pageName) {
            Object.values(pages).forEach(page => page.classList.add('hidden'));
            
            const pageToShow = pages[pageName];
            if (pageToShow) {
                pageToShow.classList.remove('hidden');
                // We re-add the animation class each time to trigger it
                pageToShow.classList.remove('page');
                void pageToShow.offsetWidth; // Trigger reflow
                pageToShow.classList.add('page');
            }


            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.dataset.page === pageName) {
                    link.classList.add('active');
                }
            });
            // Stop any ongoing speech synthesis when changing pages
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
        }

        navLinks.forEach(link => {
            link.addEventListener('click', () => showPage(link.dataset.page));
        });
        
        document.getElementById('start-solving-btn').addEventListener('click', () => showPage('solver'));

        // Markdown Converter
        const converter = new showdown.Converter();

        // Solver logic
        const solveBtn = document.getElementById('solve-btn');
        const youtubeBtn = document.getElementById('youtube-btn');
        const pdfBtn = document.getElementById('pdf-btn');
        const problemInput = document.getElementById('problem-number-input');
        const languageSelect = document.getElementById('language-select');
        const responseContainer = document.getElementById('response-container');
        const aiResponse = document.getElementById('ai-response');
        const loadingIndicator = document.getElementById('loading-indicator');
        const responseHeader = document.getElementById('response-header');

        // Text-to-Speech elements
        const ttsBtn = document.getElementById('tts-btn');
        const ttsPlayIcon = document.getElementById('tts-play-icon');
        const ttsStopIcon = document.getElementById('tts-stop-icon');
        let currentUtterance = null; 


        async function callLeetCodeAPI(problemNumber, language) {
            const fullPrompt = `Provide a full solution guide for LeetCode problem ${problemNumber} in ${language}. The guide MUST include the following sections with these exact markdown headings: ### Problem Summary, ### Hints, ### Approaches, ### Code Solution and Explanation.`;
            const encodedPrompt = encodeURIComponent(fullPrompt);
            const apiUrl = `https://text.pollinations.ai/${encodedPrompt}`;

            try {
                const response = await fetch(apiUrl);
                if (response.ok) {
                    return await response.text();
                } else {
                    return `Error: Unable to fetch response. Status: ${response.status}`;
                }
            } catch (error) {
                console.error("API call failed:", error);
                return "An error occurred while trying to contact the AI. Please check your network connection and try again.";
            }
        }

        solveBtn.addEventListener('click', async () => {
            const problemNumber = problemInput.value.trim();
            const selectedLanguage = languageSelect.value;

            if (!problemNumber) {
                aiResponse.innerHTML = "<p>Please enter a problem number or title.</p>";
                responseContainer.classList.remove('hidden');
                setTimeout(() => responseContainer.classList.add('visible'), 10);
                responseHeader.classList.add('hidden');
                return;
            }

            speechSynthesis.cancel();
            responseContainer.classList.remove('hidden');
            loadingIndicator.classList.remove('hidden');
            aiResponse.classList.add('hidden');
            responseHeader.classList.add('hidden');
            solveBtn.disabled = true;
            solveBtn.classList.add('opacity-50', 'cursor-not-allowed');
            
            setTimeout(() => {
                responseContainer.classList.add('visible');
            }, 10);

            const responseText = await callLeetCodeAPI(problemNumber, selectedLanguage);
            
            loadingIndicator.classList.add('hidden');
            aiResponse.innerHTML = converter.makeHtml(responseText);
            aiResponse.classList.remove('hidden');
            
            responseHeader.classList.remove('hidden');

            solveBtn.disabled = false;
            solveBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        });

        youtubeBtn.addEventListener('click', () => {
            const problemNumber = problemInput.value.trim();
            if (problemNumber) {
                const youtubeSearchUrl = `https://www.youtube.com/results?search_query=leetcode+${problemNumber}`;
                window.open(youtubeSearchUrl, '_blank');
            }
        });
        
        pdfBtn.addEventListener('click', () => {
            const problemNumber = problemInput.value.trim() || 'solution';
            showToast('Generating PDF...');
            const contentToCapture = aiResponse;

            // Store original styles
            const originalStyle = contentToCapture.style.cssText;

            // Temporarily apply styles for PDF generation
            contentToCapture.style.backgroundColor = '#0c0a18';
            contentToCapture.style.color = '#e5e7eb';
            contentToCapture.style.padding = '20px';

            html2canvas(contentToCapture, {
                scale: 2,
                scrollY: -window.scrollY,
                windowHeight: contentToCapture.scrollHeight,
                backgroundColor: '#0c0a18' // Ensure canvas background is dark
            }).then(canvas => {
                // Revert styles immediately after capture
                contentToCapture.style.cssText = originalStyle;

                const imgData = canvas.toDataURL('image/png');
                const imgWidth = canvas.width;
                const imgHeight = canvas.height;

                const pdf = new jsPDF({
                    orientation: 'p',
                    unit: 'pt',
                    format: 'a4'
                });

                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const ratio = imgHeight / imgWidth;
                const scaledImgHeight = pdfWidth * ratio;

                let heightLeft = scaledImgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, scaledImgHeight);
                heightLeft -= pdfHeight;

                while (heightLeft > 0) {
                    position -= pdfHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, scaledImgHeight);
                    heightLeft -= pdfHeight;
                }

                pdf.save(`Codex-Solution-${problemNumber}.pdf`);
            }).catch(err => {
                // Ensure styles are reverted even if there's an error
                contentToCapture.style.cssText = originalStyle;
                console.error("Error generating PDF:", err);
                showToast("Failed to generate PDF.");
            });
        });


        ttsBtn.addEventListener('click', () => {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
                return;
            }

            const textToSpeak = aiResponse.innerText;
            if (textToSpeak && textToSpeak.trim() !== '') {
                const utterance = new SpeechSynthesisUtterance(textToSpeak);
                currentUtterance = utterance;
                
                utterance.onstart = () => {
                    ttsPlayIcon.classList.add('hidden');
                    ttsStopIcon.classList.remove('hidden');
                };

                utterance.onend = () => {
                    ttsPlayIcon.classList.remove('hidden');
                    ttsStopIcon.classList.add('hidden');
                    currentUtterance = null;
                };
                
                utterance.onerror = (event) => {
                    console.error('An error occurred during speech synthesis:', event.error || 'Unknown error');
                    ttsPlayIcon.classList.remove('hidden');
                    ttsStopIcon.classList.add('hidden');
                    currentUtterance = null;
                };

                speechSynthesis.speak(utterance);
            }
        });

        // Interview Prep Logic
        const getQuestionsBtn = document.getElementById('get-questions-btn');
        const companyInput = document.getElementById('company-input');
        const roleInput = document.getElementById('role-input');
        const questionsContent = document.getElementById('questions-content');
        const questionsLoading = document.getElementById('questions-loading');
        const questionsDisplay = document.getElementById('questions-display');
        const toastEl = document.getElementById('toast-notification');
        const toastMessage = document.getElementById('toast-message');
        const subNavLinks = document.querySelectorAll('.sub-nav-link');
        const questionsView = document.getElementById('questions-view');
        const guideView = document.getElementById('guide-view');

        async function callInterviewQuestionsListAPI(company, role) {
            const prompt = `Give a list of common interview questions for a ${role} role at ${company}. Structure the response with clear headings for different question types like "Technical Questions", "Behavioral Questions", etc.`;
            const encodedPrompt = encodeURIComponent(prompt);
            const apiUrl = `https://text.pollinations.ai/${encodedPrompt}`;
            try {
                const response = await fetch(apiUrl);
                if (response.ok) {
                    return await response.text();
                }
                return "Error: Could not fetch interview questions.";
            } catch (error) {
                console.error("Interview questions API call failed:", error);
                return "Error: Could not fetch interview questions.";
            }
        }
        
        function showToast(message) {
            toastMessage.textContent = message;
            toastEl.classList.remove('hidden');
            setTimeout(() => toastEl.classList.remove('opacity-0'), 10);
            setTimeout(() => {
                toastEl.classList.add('opacity-0');
                setTimeout(() => toastEl.classList.add('hidden'), 300);
            }, 2700);
        }

        getQuestionsBtn.addEventListener('click', async () => {
            const company = companyInput.value.trim();
            const role = roleInput.value.trim();

            if (!company || !role) {
                showToast("Please enter both company and role.");
                return;
            }

            questionsContent.classList.add('hidden');
            questionsLoading.classList.remove('hidden');
            questionsDisplay.classList.remove('visible');
            getQuestionsBtn.disabled = true;
            getQuestionsBtn.classList.add('opacity-50');

            const responseText = await callInterviewQuestionsListAPI(company, role);
            questionsContent.innerHTML = converter.makeHtml(responseText);

            questionsLoading.classList.add('hidden');
            questionsContent.classList.remove('hidden');
            setTimeout(() => questionsDisplay.classList.add('visible'), 10);
            getQuestionsBtn.disabled = false;
            getQuestionsBtn.classList.remove('opacity-50');
        });

        subNavLinks.forEach(link => {
            link.addEventListener('click', () => {
                subNavLinks.forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                const view = link.dataset.view;
                if (view === 'questions') {
                    questionsView.classList.remove('hidden');
                    guideView.classList.add('hidden');
                } else {
                    questionsView.classList.add('hidden');
                    guideView.classList.remove('hidden');
                }
            });
        });

        // --- CHATBOT LOGIC ---
        const chatbotFab = document.getElementById('chatbot-fab');
        const mobileChatBtn = document.getElementById('mobile-chat-btn');
        const chatbotContainer = document.getElementById('chatbot-container');
        const closeChatbotBtn = document.getElementById('close-chatbot-btn');
        const chatMessages = document.getElementById('chat-messages');
        const chatInputForm = document.getElementById('chat-input-form');
        const chatInput = document.getElementById('chat-input');

        function toggleChatbot() {
            chatbotContainer.classList.toggle('visible');
        }

        chatbotFab.addEventListener('click', toggleChatbot);
        mobileChatBtn.addEventListener('click', toggleChatbot);
        closeChatbotBtn.addEventListener('click', toggleChatbot);

        function addChatMessage(message, sender) {
            const messageEl = document.createElement('div');
            messageEl.classList.add('message', 'p-3', 'rounded-lg');
            if (sender === 'user') {
                messageEl.classList.add('user-message');
                messageEl.textContent = message;
            } else {
                messageEl.classList.add('ai-message');
                // Use innerHTML for AI messages to render markdown
                messageEl.innerHTML = converter.makeHtml(message);
            }
            chatMessages.appendChild(messageEl);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function callChatbotAPI(prompt) {
            const encodedPrompt = encodeURIComponent(prompt);
            const apiUrl = `https://text.pollinations.ai/${encodedPrompt}`;
            try {
                const response = await fetch(apiUrl);
                if (response.ok) {
                    return await response.text();
                }
                return "Sorry, I couldn't get a response. Please try again.";
            } catch (error) {
                console.error("Chatbot API call failed:", error);
                return "Sorry, there was an error connecting to the AI.";
            }
        }
        
        chatInputForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (!userInput) return;

            addChatMessage(userInput, 'user');
            chatInput.value = '';
            
            // Add thinking indicator
            const thinkingEl = document.createElement('div');
            thinkingEl.classList.add('message', 'ai-message', 'p-3', 'rounded-lg', 'flex', 'items-center', 'space-x-2');
            thinkingEl.innerHTML = `
                <div class="ai-thinking-dot"></div>
                <div class="ai-thinking-dot"></div>
                <div class="ai-thinking-dot"></div>
            `;
            chatMessages.appendChild(thinkingEl);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            const aiResponseText = await callChatbotAPI(userInput);
            
            // Remove thinking indicator and add AI response
            thinkingEl.remove();
            addChatMessage(aiResponseText, 'ai');
        });


        // Show home page by default
        showPage('home');
    </script>
</body>
</html>
